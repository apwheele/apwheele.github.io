<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DuckDB WASM Parquet Query</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono&display=swap" rel="stylesheet">
</head>
<body class="container mt-5">
    <header class="text-center mb-5">
        <h1>Query Remote Parquet File with DuckDB WASM</h1>
    </header>
    <main>
        <section class="mb-4">
            <p>Enter your SQL query below to query the remote parquet file.</p>
            <textarea id="sql-query" class="form-control" rows="5" placeholder="SELECT * FROM 'https://www.timestored.com/data/sample/userdata.parquet' LIMIT 10;"></textarea>
            <button id="execute-button" class="btn btn-primary mt-3" disabled>Execute</button>
            <button id="query1-button" class="btn btn-info mt-3 ms-2" data-query="SELECT * FROM 'https://blobs.duckdb.org/data/tpch-sf0.01-parquet/orders.parquet' LIMIT 50;">Orders Limit 50</button>
            <button id="query2-button" class="btn btn-info mt-3 ms-2" data-query="SELECT count(*) FROM 'https://blobs.duckdb.org/data/tpch-sf0.01-parquet/lineitem.parquet';">Lineitem Count</button>
            <button id="query3-button" class="btn btn-info mt-3 ms-2" data-query="DESCRIBE FROM read_parquet('https://blobs.duckdb.org/stations.parquet');">Describe Stations</button>
            <div id="status-message" class="mt-2 text-muted">Initializing DuckDB...</div>
        </section>
        <section id="results-container">
            <div class="col-12">
                <div id="table-container"></div>
                <button id="download-csv-button" class="btn btn-success mt-3" style="display: none;">Download CSV</button>
            </div>
        </section>
    </main>
    <footer class="text-center mt-5">
        <p>Powered by <a href="https://duckdb.org/docs/api/wasm" target="_blank">DuckDB WASM</a></p>
    </footer>
    <script type="module">
    import * as duckdb from 'https://cdn.jsdelivr.net/npm/@duckdb/duckdb-wasm@1.28.1-dev106.0/+esm';
    window.duckdb = duckdb;
</script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script type="module" src="script.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
</body>
</html>